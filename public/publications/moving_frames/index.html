<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Quadmeshing with Seamless Parametrization Computing a high-quality quadmesh of a given object is a challenging task of geometry processing, with applications in both computer graphics and numerical simulation. A promising approach to solve this problem is to rely on a parametrization, that is a flat representation of the considered object. The idea is to overlay a grid on this parametrization which will then be pulled back onto the surface to form the quad layout." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://GCoiffier.github.io/publications/moving_frames/" />


    <title>
        
            The Method of Moving Frames for Surface Parametrization :: Guillaume Coiffier - Personal Website 
        
    </title>





<link rel="stylesheet" href="/main.7d1b805f582bb3c46d1c96e1c8a3b521f3feb98bd039f0c42cfa9690a13e47c6.css" integrity="sha256-fRuAX1grs8RtHJbhyKO1IfP&#43;uYvQOfDELPqWkKE&#43;R8Y=">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="The Method of Moving Frames for Surface Parametrization">
<meta itemprop="description" content="Quadmeshing with Seamless Parametrization Computing a high-quality quadmesh of a given object is a challenging task of geometry processing, with applications in both computer graphics and numerical simulation. A promising approach to solve this problem is to rely on a parametrization, that is a flat representation of the considered object. The idea is to overlay a grid on this parametrization which will then be pulled back onto the surface to form the quad layout."><meta itemprop="datePublished" content="2023-09-20T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-09-20T00:00:00+00:00" />
<meta itemprop="wordCount" content="1447">
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Method of Moving Frames for Surface Parametrization"/>
<meta name="twitter:description" content="Quadmeshing with Seamless Parametrization Computing a high-quality quadmesh of a given object is a challenging task of geometry processing, with applications in both computer graphics and numerical simulation. A promising approach to solve this problem is to rely on a parametrization, that is a flat representation of the considered object. The idea is to overlay a grid on this parametrization which will then be pulled back onto the surface to form the quad layout."/>







    <meta property="article:published_time" content="2023-09-20 00:00:00 &#43;0000 UTC" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                hello</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/cv">CV</a></li><li><a href="/publications">Publications</a></li>
        <div class="submenu">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">en</a>
                <div class="dropdown-content">
                    
                        
                    
                </div>
            </li>
        </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                

<link rel="stylesheet" href="https://GCoiffier.github.io/css/publication.css">
<link rel="stylesheet" href="https://GCoiffier.github.io/css/figure.css">


    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$','$']]       
    }
  };
</script>




<main class="post">
        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h1 class="paper-title"> The Method of Moving Frames for Surface Parametrization </h1>

            <div class="paper-author">
                Guillaume Coiffier, Etienne Corman
			</div>

            <div class="published">
                 <a class="paper-published"> Transaction on Graphics</a>,
                 <a> 20 September 2023</a> 
            </div>
            
            

            
                <figure class="paper-cover">
                    <img src="https://GCoiffier.github.io/img/moving_frames/cover.jpg" alt="The Method of Moving Frames for Surface Parametrization" />
                
                    
                </figure>
            
            
            <div class="paper-links">
                

                 
                <a style="padding:10px;"> 
                    <a class="paper-button" href=https://hal.science/hal-03670525> pdf </a>
                </a> 
                
                
                 
                <a style="padding:10px;"> 
                    <a class="paper-button" href=https://doi.org/10.1145/3604282> doi </a> 
                </a>
                
                
                

                 
                <a style="padding:10px;"> 
                    <a class="paper-button" href=https://homepages.loria.fr/ECorman/Papers/cartan_supp.pdf> supplemental </a> 
                </a>
                
                
                
                <a style="padding:10px;"> 
                    <a class="paper-button" href=https://github.com/GCoiffier/moving_frames_parametrization> code </a> 
                </a>
                

                

                
            </div>
			
        
        <hr />
        
        <div class="paper-abstract">
            This article introduces a new representation of surface global parametrization based on Cartanâ€™s method of moving frames. We show that a system of structure equations, characterizing the local coordinates changes with respect to a local frame system, completely characterizes the set of possible cone parametrizations. The discretization of this system provably provides necessary and sufficient conditions for the existence of a valid mapping. We are able to derive a versatile algorithm for surface parametrization, allowing feature constraints and singularities. As the first structure equation is independent of the global coordinate system, we do not require prior knowledge of cuts or cone positions. So, a single non-linear least-square problem is enough to place quantized cones while minimizing a given distortion energy. We are therefore able to take full advantage of the link between the parametrization geometry and the topology of its cone metric to solve challenging constrained parametrization problems.
        </div>
        
        
        <hr />
            <div class="paper-content">
                <h2 id="quadmeshing-with-seamless-parametrization">Quadmeshing with Seamless Parametrization</h2>
<p>Computing a high-quality quadmesh of a given object is a challenging task of geometry processing, with applications in both computer graphics and numerical simulation. A promising approach to solve this problem is to rely on a parametrization, that is a flat representation of the considered object. The idea is to overlay a grid on this parametrization which will then be pulled back onto the surface to form the quad layout. For this, the parametrization needs to have very specific properties, namely be an <em>(integer) seamless parametrization</em>, or integer grid map.</p>

    <img class="figure" 
    src="/img/moving_frames/integer_grid_map.jpg" 
     
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 1. </a> The parametrization-based approach enables the computation of a high-quality quad mesh. The idea is to compute a flat represenation (parametrization) of the object, over which a grid is overlaid before being pulled back onto the surface. However, the parametrization needs to satisfy very specific constraints for a quad layout to be extracted.</p>
    


<p>Let $M=(V,E,F)$ be a triangle mesh. A parametrization of $\phi$ is a mapping from $M$ to the plane $\mathbb{R}^2 \cong \mathbb{C}$. In practice, such mappings are represented by the coordinates in the place of each triangle corners, or, equivalently, as a linear transformation per triangle (Fig. 2a). In other word, having $\phi$ mapping a triangle on the surface to a triangle in parameter space is a commonly applied restriction.</p>
<p>A <em>seamless parametrization</em> is a parametrization with two additionnal properties:</p>
<ul>
<li>Across a discontinuity of $\phi$, two versions of the same edge should match up to some rotation of angle $k\pi/2$ and some arbitrary translation (Fig. 2b)</li>
<li>Any boundary curve should be axis-aligned in parameter space (Fig. 2c)</li>
</ul>
<p>To get an <em>integer grid map</em>, that is a seamless parametrization aligned with the integer grid, we require that the translations across discontinuities have integer coordinates (Fig. 2d).</p>

    <img class="figure" 
    src="/img/moving_frames/param_def.jpeg" 
     
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 2. </a> The different properties of a seamless parametrization. (a) Piecewise-linear parametrization. (b) Rotationally seamless parametrization. (c) Boundary-adapted seamless parametrization. (d) Integer grid map (quantized seamless parametrization)</p>
    


<p>When working with a seamless map, the exact location of the discontinuities (seams) of $\phi$ do not matter. What matters is where they end. Those ending points are called <em>cones</em> or <em>singularities</em>. In short, these points are where the curvature of the original mesh is concentrated as multiples of $\pi/2$. They will correspond to irregular vertices in the final quad mesh.</p>
<p>Computing an integer grid map is a challenging problem to formulate and solve in one go. This is why most state of the art method split the problem into several steps:</p>
<ol>
<li>Compute the position of the cones;</li>
<li>Compute a seamless map that conforms to the cone distribution;</li>
<li>Deform this seamless map to recover an integer grid map.</li>
</ol>

    <img class="figure" 
    src="/img/moving_frames/pipeline.jpeg" 
     
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 3. </a> The usual parametrization-based meshing pipeline. As the problem of computing an integer grid map is too challenging to be tackled directly, state of the art method split it into several steps. While mostly successful, this approach is not without downsides.</p>
    


<p>Although it provides good results most of the time, splitting the problem has also brought its own issues. Firstly, as problems are solved indepently, greedy choices are often made at some step that invalidates the result of the next step. For instance, not all cone distribution can yield a valid seamless parametrization. Moreover, the distribution of cones on the surface has a clear impact on the parametrization&rsquo;s distortion and the quality of elements in the final quadmesh. Determining the cones before computing the mapping prevents a method from taking advantage of this connection. This is why we propose an optimization that <em>simultaneously computes a cone distribution and a seamless parametrization</em>, thus merging the two first steps of the pipeline in a single one.</p>
<h2 id="the-method-of-moving-frames">The Method of Moving Frames</h2>
<p>The method of moving frames is a general framework developed by Elie Cartan to describe local deformations in differential geometry. At its heart is a set of <em>structure equations</em> which linka local deformation field with the local frames of reference. In this work, we extend the method to singular frame fields, allowing cones to appear, and apply it to the computation of seamless parametrization of triangle meshes.</p>
<h3 id="face-based-vs-vertex-based-discretization">Face-based vs Vertex-based Discretization</h3>
<p>As the theory of Cartan deals with smooth manifolds, one first need to discretize it to be used on surface meshes. There are at least two ways of doing it, both with pros and cons:</p>
<ul>
<li>In the article, we describe a &ldquo;dual&rdquo; vertex-based approach, where frames are located at vertices of a mesh. Only this approach garantees injectivity of the final parametrization (as it prevents double coverings around vertices).</li>
<li>Here, we present a simpler face-based approach, where frames are located inside triangles. This discretization is simpler to understand and implement, but theoretical garantees about injectivity cannot be drawn anymore.</li>
</ul>
<p>In <a href="https://github.com/GCoiffier/moving_frames_parametrization">our implementation</a>, both versions are available.</p>
<h3 id="the-structure-equations">The Structure Equations</h3>
<p>Let $M=(V,E,T)$ be a manifold triangle mesh. To express Cartan&rsquo;s structure equations on $M$, we need to define the following variables:</p>
<ul>
<li>A Jacobian matrix $J_t$ per triangle $t \in T$, which will represent our parametrization $\phi$ as local linear deformations</li>
<li>A $1$-form $\omega \in \mathbb{R}$ per edge</li>
<li>A frame per triangle $v_t \in \mathbb{C}$ per triangle $t \in T$ that satisfies the symetries of the square. We use the classical <a href="https://www.graphics.rwth-aachen.de/media/papers/315/DirectionalFieldsSTAR-2016.pdf">power vector representation</a></li>
</ul>

    <img class="figure" 
    src="/img/moving_frames/notations.jpeg" 
     
     style="width:500px;"  
    />
    
    <p class="figure-caption"  style="width:500px;" > <a style="font-weight: bold;">Figure 4. </a> Notations and variables of the parametrization problem</p>
    


<p>Given these variables, Cartan&rsquo;s structure equations can be expressed as follows:</p>
<p>$$\left\{\begin{align}
\exp(\imath \omega_{ij}) r_{ij} J_j e_{ji} &amp;= J_i e_{ij} &amp;\text{  (First Structure Equation)} \\
\exp(\imath \omega_{ij})^4 r_{ij}^4 v_i &amp;= v_j &amp;\text{  (Frames Regularity)} \\
\det{J} &amp;&gt; 0 &amp;\text{   (Local injectivity)}
\end{align}\right.$$</p>
<p>where $r_{ij}$ is the <a href="http://wordpress.discretization.de/geometryprocessingandapplicationsws19/connections-and-parallel-transport/">parallel transport</a> between triangles $i$ and $j$ (some precomputed fixed rotation to account for change of local bases).</p>
<h3 id="cayley-transform">Cayley Transform</h3>
<p>To avoid optimizing through the exponential in the above system of equations, we make a change of variables. Instead of working with an angle $\omega$, we work with $\hat{\omega} = \tan{\omega/2}$ and apply a <a href="https://en.wikipedia.org/wiki/Cayley_transform#Complex_homography"><em>Cayley Transform</em></a>:</p>
<p>$$\exp \left( \imath \omega \right) = \frac{1 - \imath \hat{\omega}/2 }{1 + \imath \hat{\omega}/2}$$</p>
<p>which means that the equations are transformed as:</p>
<p>$$\left\{\begin{align}
(1 - \imath \omega_{ij}/2) r_{ij} J_j e_{ji} &amp;= (1 + \imath \omega_{ij}/2) J_i e_{ij} &amp; \text{ (First Structure Equation - Cayley)} \\
(1 - \imath \omega_{ij}/2)^4 r_{ij}^4 v_i &amp;= (1 + \imath \omega_{ij}/2)^4 v_i &amp; \text{ (Frames Regularity - Cayley)}
\end{align}\right.$$</p>
<p>This system of equation per pairs of triangles is then fed into a <a href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm"><em>Levenberg-Marquardt</em></a> optimizer in order to find a solution in terms of $J,\omega$ and $v$.</p>
<h3 id="parametrization-reconstruction">Parametrization Reconstruction</h3>
<p>After the optimization, we have a set of linear transformations $J_t$ per triangle. If the structure equations are satisfied, the transformed triangles can be assembled back in a seamless parametrization following these steps:</p>
<ol>
<li>Reconstruct triangles independently by applying their matrix $J_t$ to their initial coordinates;</li>
<li>Recover a basis $z$ per triangle from the power vector $v$ by finding the smallest symmetry rotation along a spanning tree;</li>
<li>Rotate each triangle with relation to their respective bases;</li>
<li>Recursively stitch adjacent triangles along the tree.</li>
</ol>

    <img class="figure" 
    src="/img/moving_frames/reconstruct.jpeg" 
     alt="Three meshes with displayed parametrization as a checker texture, optimized with different distortion criteria. Each mesh display a different distribution of singularities (shown as little red/blue spheres on the surface)."  
     style="width:100%;"  
    />
    
    <p style="margin-top: 20px;"> </p>
    


<p>By doing so, singularities naturally appear as predicted by the $1$-form $\omega$. Note that the seamless parametrization does not come from the frame field variables in a classical integration procedure, but rather from the Jacobians.</p>
<h3 id="distortion-minimization">Distortion minimization</h3>
<p>As Jacobian matrices of the parametrization are available during optimization, one can try to minimize some distortion criterion alongside the structure equations to bias the optimization towards certain kinds of parametrizations. Basically any smooth function of the Jacobian matrices can be optimized in this manner. Some interesting functions are:</p>
<p>$$\begin{align}
\mathcal{D}_{\text{Conformal}}(J) &amp;= \sum_{t \in T} \left| J_t - \begin{pmatrix} 0 &amp; -1 \\ 1 &amp; 0 \end{pmatrix} J_t \right|^2 \\ \\
\mathcal{D}_{\text{Isometric}}(J) &amp;= \sum_{t \in T} | J_t^T J_t - I_2 |^2 \\ \\
\mathcal{D}_{\text{Area-preserving}}(J) &amp;= \sum_{t \in T} | \det(J_t) - 1 |^2 + \varepsilon \mathcal{D}_{\text{Conformal}}(J)
\end{align}
$$</p>
<p>as we can see on Fig. 6 (and on the representative image on top of the page), minimizing those different criteria lead to a different placement of cones. In other words, we were able to influence the distribution of singularity cones in order to better minimize the distortion of the parametrization.</p>

    <img class="figure" 
    src="/img/moving_frames/distortion.jpeg" 
     alt="Three meshes with displayed parametrization as a checker texture, optimized with different distortion criteria. Each mesh display a different distribution of singularity cones (shown as little red/blue spheres on the surface)."  
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 6. </a> Optimization of the same model while minimizing different distortion criteria. The optimization yields different cone distributions whether we optimize for an angle-preserving (conformal) or area-preserving mapping.</p>
    


<h2 id="gallery-of-results">Gallery of results</h2>

    <img class="figure" 
    src="/img/moving_frames/mosaic2.jpeg" 
     alt="Many surface meshes in a mosaic with computed parametrization and cones displayed as a checker texture and little red/blue spheres."  
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 7. </a> Gallery of results on a variety of models.</p>
    



    <img class="figure" 
    src="/img/moving_frames/gallery_quads.jpg" 
     alt="Many quadmeshes in a mosaic"  
     style="width:100%;"  
    />
    
    <p class="figure-caption"  style="width:100%;" > <a style="font-weight: bold;">Figure 8. </a> Gallery of quadmeshes obtained using our parametrization algorithm.</p>
    


<h2 id="bibtex">BibTeX</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-latex" data-lang="latex">@article{coiffier2023movingframes,
	author = {Coiffier, Guillaume and Corman, Etienne},
	title = {The Method of Moving Frames for Surface Global Parametrization},
	year = {2023},
	issue_date = {October 2023},
	publisher = {Association for Computing Machinery},
	volume = {42},
	number = {5},
	issn = {0730-0301},
	url = {https://doi.org/10.1145/3604282},
	doi = {10.1145/3604282},
	journal = {ACM Trans. Graph.},
	month = {sep},
	articleno = {166},
	numpages = {18}
}
</code></pre></div>
            </div>
        
        </article>

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.b66ca78575c5a257714b9b805cec38c36e873ee6a439d4fafcfcdbdcef6c61f850c1763deac2a3b1612865d9457c06812251cbd66b803603ec4a126d20bf0c25.js" integrity="sha512-tmynhXXFoldxS5uAXOw4w26HPuakOdT6/Pzb3O9sYfhQwXY96sKjsWEoZdlFfAaBIlHL1muANgPsShJtIL8MJQ=="></script>



    </body>
</html>
